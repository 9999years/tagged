<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Data/Tagged.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE CPP #-}</span>
<a name="line-2"></a><span class='hs-cpp'>#ifdef LANGUAGE_DeriveDataTypeable</span>
<a name="line-3"></a><span class='hs-comment'>{-# LANGUAGE DeriveDataTypeable #-}</span>
<a name="line-4"></a><span class='hs-cpp'>#endif</span>
<a name="line-5"></a><span class='hs-cpp'>#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 706</span>
<a name="line-6"></a><span class='hs-comment'>{-# LANGUAGE PolyKinds #-}</span>
<a name="line-7"></a><span class='hs-cpp'>#endif</span>
<a name="line-8"></a><span class='hs-comment'>----------------------------------------------------------------------------</span>
<a name="line-9"></a><span class='hs-comment'>-- |</span>
<a name="line-10"></a><span class='hs-comment'>-- Module     : Data.Tagged</span>
<a name="line-11"></a><span class='hs-comment'>-- Copyright  : 2009-2012 Edward Kmett</span>
<a name="line-12"></a><span class='hs-comment'>-- License    : BSD3</span>
<a name="line-13"></a><span class='hs-comment'>--</span>
<a name="line-14"></a><span class='hs-comment'>-- Maintainer  : Edward Kmett &lt;ekmett@gmail.com&gt;</span>
<a name="line-15"></a><span class='hs-comment'>-- Stability   : experimental</span>
<a name="line-16"></a><span class='hs-comment'>-- Portability : portable</span>
<a name="line-17"></a><span class='hs-comment'>--</span>
<a name="line-18"></a><span class='hs-comment'>-------------------------------------------------------------------------------</span>
<a name="line-19"></a>
<a name="line-20"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Tagged</span>
<a name="line-21"></a>    <span class='hs-layout'>(</span>
<a name="line-22"></a>    <span class='hs-comment'>-- * Tagged values</span>
<a name="line-23"></a>      <span class='hs-conid'>Tagged</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span>
<a name="line-24"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>retag</span>
<a name="line-25"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>untag</span>
<a name="line-26"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>tagSelf</span>
<a name="line-27"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>untagSelf</span>
<a name="line-28"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>asTaggedTypeOf</span>
<a name="line-29"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>witness</span>
<a name="line-30"></a>    <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-31"></a>
<a name="line-32"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Applicative</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varop'>&lt;$&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>liftA2</span><span class='hs-layout'>,</span> <span class='hs-conid'>Applicative</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-33"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Monad</span> <span class='hs-layout'>(</span><span class='hs-varid'>liftM</span><span class='hs-layout'>)</span>
<a name="line-34"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Traversable</span> <span class='hs-layout'>(</span><span class='hs-conid'>Traversable</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-35"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Foldable</span> <span class='hs-layout'>(</span><span class='hs-conid'>Foldable</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-36"></a><span class='hs-cpp'>#ifdef __GLASGOW_HASKELL__</span>
<a name="line-37"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Data</span>
<a name="line-38"></a><span class='hs-cpp'>#endif</span>
<a name="line-39"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Ix</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ix</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-40"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Monoid</span>
<a name="line-41"></a>
<a name="line-42"></a><a name="Tagged"></a><span class='hs-comment'>-- | A @'Tagged' s b@ value is a value @b@ with an attached phantom type @s@.</span>
<a name="line-43"></a><a name="Tagged"></a><span class='hs-comment'>-- This can be used in place of the more traditional but less safe idiom of</span>
<a name="line-44"></a><a name="Tagged"></a><span class='hs-comment'>-- passing in an undefined value with the type, because unlike an @(s -&gt; b)@,</span>
<a name="line-45"></a><a name="Tagged"></a><span class='hs-comment'>-- a @'Tagged' s b@ can't try to use the argument @s@ as a real value.</span>
<a name="line-46"></a><a name="Tagged"></a><span class='hs-comment'>--</span>
<a name="line-47"></a><a name="Tagged"></a><span class='hs-comment'>-- Moreover, you don't have to rely on the compiler to inline away the extra</span>
<a name="line-48"></a><a name="Tagged"></a><span class='hs-comment'>-- argument, because the newtype is \"free\"</span>
<a name="line-49"></a><a name="Tagged"></a><span class='hs-keyword'>newtype</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span> <span class='hs-layout'>{</span> <span class='hs-varid'>unTagged</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>b</span> <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span>
<a name="line-50"></a>  <span class='hs-layout'>(</span> <span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>Ord</span><span class='hs-layout'>,</span> <span class='hs-conid'>Ix</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bounded</span>
<a name="line-51"></a><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &gt;= 707</span>
<a name="line-52"></a>  <span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span>
<a name="line-53"></a><span class='hs-cpp'>#endif</span>
<a name="line-54"></a>  <span class='hs-layout'>)</span>
<a name="line-55"></a>
<a name="line-56"></a><span class='hs-cpp'>#ifdef __GLASGOW_HASKELL__</span>
<a name="line-57"></a><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &lt; 707</span>
<a name="line-58"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Typeable2</span> <span class='hs-conid'>Tagged</span> <span class='hs-keyword'>where</span>
<a name="line-59"></a>  <span class='hs-varid'>typeOf2</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkTyConApp</span> <span class='hs-varid'>taggedTyCon</span> <span class='hs-conid'>[]</span>
<a name="line-60"></a>
<a name="line-61"></a><a name="taggedTyCon"></a><span class='hs-definition'>taggedTyCon</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>TyCon</span>
<a name="line-62"></a><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &lt; 704</span>
<a name="line-63"></a><span class='hs-definition'>taggedTyCon</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkTyCon</span> <span class='hs-str'>"Data.Tagged.Tagged"</span>
<a name="line-64"></a><span class='hs-cpp'>#else</span>
<a name="line-65"></a><span class='hs-definition'>taggedTyCon</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkTyCon3</span> <span class='hs-str'>"tagged"</span> <span class='hs-str'>"Data.Tagged"</span> <span class='hs-str'>"Tagged"</span>
<a name="line-66"></a><span class='hs-cpp'>#endif</span>
<a name="line-67"></a>
<a name="line-68"></a><span class='hs-cpp'>#endif</span>
<a name="line-69"></a>
<a name="line-70"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-71"></a>  <span class='hs-varid'>gfoldl</span> <span class='hs-varid'>f</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>z</span> <span class='hs-conid'>Tagged</span> <span class='hs-varop'>`f`</span> <span class='hs-varid'>b</span>
<a name="line-72"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>taggedConstr</span>
<a name="line-73"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-varid'>k</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrIndex</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-74"></a>    <span class='hs-num'>1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-varid'>z</span> <span class='hs-conid'>Tagged</span><span class='hs-layout'>)</span>
<a name="line-75"></a>    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>error</span> <span class='hs-str'>"gunfold"</span>
<a name="line-76"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>taggedDataType</span>
<a name="line-77"></a>  <span class='hs-varid'>dataCast1</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcast1</span> <span class='hs-varid'>f</span>
<a name="line-78"></a>  <span class='hs-varid'>dataCast2</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcast2</span> <span class='hs-varid'>f</span>
<a name="line-79"></a>
<a name="line-80"></a><a name="taggedConstr"></a><span class='hs-definition'>taggedConstr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Constr</span>
<a name="line-81"></a><span class='hs-definition'>taggedConstr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkConstr</span> <span class='hs-varid'>taggedDataType</span> <span class='hs-str'>"Tagged"</span> <span class='hs-conid'>[]</span> <span class='hs-conid'>Prefix</span>
<a name="line-82"></a><span class='hs-comment'>{-# INLINE taggedConstr #-}</span>
<a name="line-83"></a>
<a name="line-84"></a><a name="taggedDataType"></a><span class='hs-definition'>taggedDataType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-85"></a><span class='hs-definition'>taggedDataType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkDataType</span> <span class='hs-str'>"Data.Tagged.Tagged"</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>taggedConstr</span><span class='hs-keyglyph'>]</span>
<a name="line-86"></a><span class='hs-comment'>{-# INLINE taggedDataType #-}</span>
<a name="line-87"></a><span class='hs-cpp'>#endif</span>
<a name="line-88"></a>
<a name="line-89"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Show</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Show</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-90"></a>    <span class='hs-varid'>showsPrec</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>showParen</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>10</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<a name="line-91"></a>        <span class='hs-varid'>showString</span> <span class='hs-str'>"Tagged "</span> <span class='hs-varop'>.</span>
<a name="line-92"></a>        <span class='hs-varid'>showsPrec</span> <span class='hs-num'>11</span> <span class='hs-varid'>b</span>
<a name="line-93"></a>
<a name="line-94"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Read</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Read</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-95"></a>    <span class='hs-varid'>readsPrec</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>readParen</span> <span class='hs-layout'>(</span><span class='hs-varid'>d</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>10</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-96"></a>        <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-str'>"Tagged"</span><span class='hs-layout'>,</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>lex</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>readsPrec</span> <span class='hs-num'>11</span> <span class='hs-varid'>s</span><span class='hs-keyglyph'>]</span>
<a name="line-97"></a>
<a name="line-98"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Monoid</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Monoid</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-99"></a>    <span class='hs-varid'>mempty</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>mempty</span>
<a name="line-100"></a>    <span class='hs-varid'>mappend</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span> <span class='hs-layout'>(</span><span class='hs-varid'>mappend</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-101"></a>
<a name="line-102"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Functor</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-103"></a>    <span class='hs-varid'>fmap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-104"></a>    <span class='hs-comment'>{-# INLINE fmap #-}</span>
<a name="line-105"></a>
<a name="line-106"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Applicative</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-107"></a>    <span class='hs-varid'>pure</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span>
<a name="line-108"></a>    <span class='hs-comment'>{-# INLINE pure #-}</span>
<a name="line-109"></a>    <span class='hs-conid'>Tagged</span> <span class='hs-varid'>f</span> <span class='hs-varop'>&lt;*&gt;</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-110"></a>    <span class='hs-comment'>{-# INLINE (&lt;*&gt;) #-}</span>
<a name="line-111"></a>
<a name="line-112"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Monad</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-113"></a>    <span class='hs-varid'>return</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span>
<a name="line-114"></a>    <span class='hs-comment'>{-# INLINE return #-}</span>
<a name="line-115"></a>    <span class='hs-conid'>Tagged</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>k</span> <span class='hs-varid'>m</span>
<a name="line-116"></a>    <span class='hs-comment'>{-# INLINE (&gt;&gt;=) #-}</span>
<a name="line-117"></a>    <span class='hs-keyword'>_</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>n</span>
<a name="line-118"></a>    <span class='hs-comment'>{-# INLINE (&gt;&gt;) #-}</span>
<a name="line-119"></a>
<a name="line-120"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Foldable</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-121"></a>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span>
<a name="line-122"></a>    <span class='hs-comment'>{-# INLINE foldMap #-}</span>
<a name="line-123"></a>    <span class='hs-varid'>fold</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<a name="line-124"></a>    <span class='hs-comment'>{-# INLINE fold #-}</span>
<a name="line-125"></a>    <span class='hs-varid'>foldr</span> <span class='hs-varid'>f</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span> <span class='hs-varid'>z</span>
<a name="line-126"></a>    <span class='hs-comment'>{-# INLINE foldr #-}</span>
<a name="line-127"></a>    <span class='hs-varid'>foldl</span> <span class='hs-varid'>f</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>z</span> <span class='hs-varid'>x</span>
<a name="line-128"></a>    <span class='hs-comment'>{-# INLINE foldl #-}</span>
<a name="line-129"></a>    <span class='hs-varid'>foldl1</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<a name="line-130"></a>    <span class='hs-comment'>{-# INLINE foldl1 #-}</span>
<a name="line-131"></a>    <span class='hs-varid'>foldr1</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<a name="line-132"></a>    <span class='hs-comment'>{-# INLINE foldr1 #-}</span>
<a name="line-133"></a>
<a name="line-134"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Traversable</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-135"></a>    <span class='hs-varid'>traverse</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span>
<a name="line-136"></a>    <span class='hs-comment'>{-# INLINE traverse #-}</span>
<a name="line-137"></a>    <span class='hs-varid'>sequenceA</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>x</span>
<a name="line-138"></a>    <span class='hs-comment'>{-# INLINE sequenceA #-}</span>
<a name="line-139"></a>    <span class='hs-varid'>mapM</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftM</span> <span class='hs-conid'>Tagged</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-140"></a>    <span class='hs-comment'>{-# INLINE mapM #-}</span>
<a name="line-141"></a>    <span class='hs-varid'>sequence</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftM</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span>
<a name="line-142"></a>    <span class='hs-comment'>{-# INLINE sequence #-}</span>
<a name="line-143"></a>
<a name="line-144"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Enum</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Enum</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-145"></a>    <span class='hs-varid'>succ</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>succ</span>
<a name="line-146"></a>    <span class='hs-varid'>pred</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>pred</span>
<a name="line-147"></a>    <span class='hs-varid'>toEnum</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span> <span class='hs-varop'>.</span> <span class='hs-varid'>toEnum</span>
<a name="line-148"></a>    <span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>x</span>
<a name="line-149"></a>    <span class='hs-varid'>enumFrom</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-conid'>Tagged</span> <span class='hs-layout'>(</span><span class='hs-varid'>enumFrom</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-150"></a>    <span class='hs-varid'>enumFromThen</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-conid'>Tagged</span> <span class='hs-layout'>(</span><span class='hs-varid'>enumFromThen</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span>
<a name="line-151"></a>    <span class='hs-varid'>enumFromTo</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-conid'>Tagged</span> <span class='hs-layout'>(</span><span class='hs-varid'>enumFromTo</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span>
<a name="line-152"></a>    <span class='hs-varid'>enumFromThenTo</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>z</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-153"></a>        <span class='hs-varid'>map</span> <span class='hs-conid'>Tagged</span> <span class='hs-layout'>(</span><span class='hs-varid'>enumFromThenTo</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>z</span><span class='hs-layout'>)</span>
<a name="line-154"></a>
<a name="line-155"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Num</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-156"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>+</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftA2</span> <span class='hs-layout'>(</span><span class='hs-varop'>+</span><span class='hs-layout'>)</span>
<a name="line-157"></a>    <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftA2</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-layout'>)</span>
<a name="line-158"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>*</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftA2</span> <span class='hs-layout'>(</span><span class='hs-varop'>*</span><span class='hs-layout'>)</span>
<a name="line-159"></a>    <span class='hs-varid'>negate</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>negate</span>
<a name="line-160"></a>    <span class='hs-varid'>abs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>abs</span>
<a name="line-161"></a>    <span class='hs-varid'>signum</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>signum</span>
<a name="line-162"></a>    <span class='hs-varid'>fromInteger</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span> <span class='hs-varop'>.</span> <span class='hs-varid'>fromInteger</span>
<a name="line-163"></a>
<a name="line-164"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Real</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Real</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-165"></a>    <span class='hs-varid'>toRational</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toRational</span> <span class='hs-varid'>x</span>
<a name="line-166"></a>
<a name="line-167"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Integral</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-168"></a>    <span class='hs-varid'>quot</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftA2</span> <span class='hs-varid'>quot</span>
<a name="line-169"></a>    <span class='hs-varid'>rem</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftA2</span> <span class='hs-varid'>rem</span>
<a name="line-170"></a>    <span class='hs-varid'>div</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftA2</span> <span class='hs-varid'>div</span>
<a name="line-171"></a>    <span class='hs-varid'>mod</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftA2</span> <span class='hs-varid'>mod</span>
<a name="line-172"></a>    <span class='hs-varid'>quotRem</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-173"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>quotRem</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span>
<a name="line-174"></a>    <span class='hs-varid'>divMod</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-175"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divMod</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span>
<a name="line-176"></a>    <span class='hs-varid'>toInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toInteger</span> <span class='hs-varid'>x</span>
<a name="line-177"></a>
<a name="line-178"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Fractional</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Fractional</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-179"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>/</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftA2</span> <span class='hs-layout'>(</span><span class='hs-varop'>/</span><span class='hs-layout'>)</span>
<a name="line-180"></a>    <span class='hs-varid'>recip</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>recip</span>
<a name="line-181"></a>    <span class='hs-varid'>fromRational</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span> <span class='hs-varop'>.</span> <span class='hs-varid'>fromRational</span>
<a name="line-182"></a>
<a name="line-183"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Floating</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Floating</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-184"></a>    <span class='hs-varid'>pi</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>pi</span>
<a name="line-185"></a>    <span class='hs-varid'>exp</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>exp</span>
<a name="line-186"></a>    <span class='hs-varid'>log</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>log</span>
<a name="line-187"></a>    <span class='hs-varid'>sqrt</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>sqrt</span>
<a name="line-188"></a>    <span class='hs-varid'>sin</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>sin</span>
<a name="line-189"></a>    <span class='hs-varid'>cos</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>cos</span>
<a name="line-190"></a>    <span class='hs-varid'>tan</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>tan</span>
<a name="line-191"></a>    <span class='hs-varid'>asin</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>asin</span>
<a name="line-192"></a>    <span class='hs-varid'>acos</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>acos</span>
<a name="line-193"></a>    <span class='hs-varid'>atan</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>atan</span>
<a name="line-194"></a>    <span class='hs-varid'>sinh</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>sinh</span>
<a name="line-195"></a>    <span class='hs-varid'>cosh</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>cosh</span>
<a name="line-196"></a>    <span class='hs-varid'>tanh</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>tanh</span>
<a name="line-197"></a>    <span class='hs-varid'>asinh</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>asinh</span>
<a name="line-198"></a>    <span class='hs-varid'>acosh</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>acosh</span>
<a name="line-199"></a>    <span class='hs-varid'>atanh</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>atanh</span>
<a name="line-200"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>**</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftA2</span> <span class='hs-layout'>(</span><span class='hs-varop'>**</span><span class='hs-layout'>)</span>
<a name="line-201"></a>    <span class='hs-varid'>logBase</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftA2</span> <span class='hs-layout'>(</span><span class='hs-varop'>**</span><span class='hs-layout'>)</span>
<a name="line-202"></a>
<a name="line-203"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>RealFrac</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>RealFrac</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-204"></a>    <span class='hs-varid'>properFraction</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-205"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>properFraction</span> <span class='hs-varid'>x</span>
<a name="line-206"></a>    <span class='hs-varid'>truncate</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>truncate</span> <span class='hs-varid'>x</span>
<a name="line-207"></a>    <span class='hs-varid'>round</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>round</span> <span class='hs-varid'>x</span>
<a name="line-208"></a>    <span class='hs-varid'>ceiling</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ceiling</span> <span class='hs-varid'>x</span>
<a name="line-209"></a>    <span class='hs-varid'>floor</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>floor</span> <span class='hs-varid'>x</span>
<a name="line-210"></a>
<a name="line-211"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>RealFloat</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>RealFloat</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-212"></a>    <span class='hs-varid'>floatRadix</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>floatRadix</span> <span class='hs-varid'>x</span>
<a name="line-213"></a>    <span class='hs-varid'>floatDigits</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>floatDigits</span> <span class='hs-varid'>x</span>
<a name="line-214"></a>    <span class='hs-varid'>floatRange</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>floatRange</span> <span class='hs-varid'>x</span>
<a name="line-215"></a>    <span class='hs-varid'>decodeFloat</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>decodeFloat</span> <span class='hs-varid'>x</span>
<a name="line-216"></a>    <span class='hs-varid'>encodeFloat</span> <span class='hs-varid'>m</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span> <span class='hs-layout'>(</span><span class='hs-varid'>encodeFloat</span> <span class='hs-varid'>m</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-217"></a>    <span class='hs-varid'>exponent</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exponent</span> <span class='hs-varid'>x</span>
<a name="line-218"></a>    <span class='hs-varid'>significand</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>significand</span>
<a name="line-219"></a>    <span class='hs-varid'>scaleFloat</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-layout'>(</span><span class='hs-varid'>scaleFloat</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-220"></a>    <span class='hs-varid'>isNaN</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isNaN</span> <span class='hs-varid'>x</span>
<a name="line-221"></a>    <span class='hs-varid'>isInfinite</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isInfinite</span> <span class='hs-varid'>x</span>
<a name="line-222"></a>    <span class='hs-varid'>isDenormalized</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isDenormalized</span> <span class='hs-varid'>x</span>
<a name="line-223"></a>    <span class='hs-varid'>isNegativeZero</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isNegativeZero</span> <span class='hs-varid'>x</span>
<a name="line-224"></a>    <span class='hs-varid'>isIEEE</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isIEEE</span> <span class='hs-varid'>x</span>
<a name="line-225"></a>    <span class='hs-varid'>atan2</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftA2</span> <span class='hs-varid'>atan2</span>
<a name="line-226"></a>
<a name="line-227"></a><a name="retag"></a><span class='hs-comment'>-- | Some times you need to change the tag you have lying around.</span>
<a name="line-228"></a><span class='hs-comment'>-- Idiomatic usage is to make a new combinator for the relationship between the</span>
<a name="line-229"></a><span class='hs-comment'>-- tags that you want to enforce, and define that combinator using 'retag'.</span>
<a name="line-230"></a><span class='hs-comment'>--</span>
<a name="line-231"></a><span class='hs-comment'>-- @</span>
<a name="line-232"></a><span class='hs-comment'>-- data Succ n</span>
<a name="line-233"></a><span class='hs-comment'>-- retagSucc :: 'Tagged' n a -&gt; 'Tagged' (Succ n) a</span>
<a name="line-234"></a><span class='hs-comment'>-- retagSucc = 'retag'</span>
<a name="line-235"></a><span class='hs-comment'>-- @</span>
<a name="line-236"></a><span class='hs-definition'>retag</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>t</span> <span class='hs-varid'>b</span>
<a name="line-237"></a><span class='hs-definition'>retag</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span> <span class='hs-varop'>.</span> <span class='hs-varid'>unTagged</span>
<a name="line-238"></a><span class='hs-comment'>{-# INLINE retag #-}</span>
<a name="line-239"></a>
<a name="line-240"></a><a name="untag"></a><span class='hs-comment'>-- | Alias for 'unTagged'</span>
<a name="line-241"></a><span class='hs-definition'>untag</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span>
<a name="line-242"></a><span class='hs-definition'>untag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unTagged</span>
<a name="line-243"></a>
<a name="line-244"></a><a name="tagSelf"></a><span class='hs-comment'>-- | Tag a value with its own type.</span>
<a name="line-245"></a><span class='hs-definition'>tagSelf</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span>
<a name="line-246"></a><span class='hs-definition'>tagSelf</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tagged</span>
<a name="line-247"></a><span class='hs-comment'>{-# INLINE tagSelf #-}</span>
<a name="line-248"></a>
<a name="line-249"></a><a name="asTaggedTypeOf"></a><span class='hs-comment'>-- | 'asTaggedTypeOf' is a type-restricted version of 'const'. It is usually used as an infix operator, and its typing forces its first argument (which is usually overloaded) to have the same type as the tag of the second.</span>
<a name="line-250"></a><span class='hs-definition'>asTaggedTypeOf</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>s</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>s</span>
<a name="line-251"></a><span class='hs-definition'>asTaggedTypeOf</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>const</span>
<a name="line-252"></a><span class='hs-comment'>{-# INLINE asTaggedTypeOf #-}</span>
<a name="line-253"></a>
<a name="line-254"></a><a name="witness"></a><span class='hs-definition'>witness</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span>
<a name="line-255"></a><span class='hs-definition'>witness</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>b</span>
<a name="line-256"></a><span class='hs-comment'>{-# INLINE witness #-}</span>
<a name="line-257"></a>
<a name="line-258"></a><a name="untagSelf"></a><span class='hs-comment'>-- | 'untagSelf' is a type-restricted version of 'untag'.</span>
<a name="line-259"></a><span class='hs-definition'>untagSelf</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Tagged</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<a name="line-260"></a><span class='hs-definition'>untagSelf</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<a name="line-261"></a><span class='hs-comment'>{-# INLINE untagSelf #-}</span>
</pre></body>
</html>
